<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Ficha de Produ√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @page {
            size: A4 portrait;
            margin: 0;
        }

        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            body {
                margin: 0 !important;
                padding: 0 !important;
            }

            @page {
                margin: 0;
                size: A4 portrait;
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            color: #1a1a1a;
            background: #fff;
            -webkit-font-smoothing: antialiased;
            margin: 0;
            padding: 0;
        }

        /* FICHA - 148mm (2 √ó 148 = 296mm, cabe em 297mm) */
        .ficha {
            width: 98%;
            margin: 0 auto;
            height: 148mm;
            max-height: 148mm;
            min-height: 148mm;
            position: relative;
            page-break-inside: avoid !important;
            padding: 5mm;
            overflow: hidden;
            display: block;
            box-sizing: border-box;
        }

        /* HEADER - 7mm fixo */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 7mm;
            border-bottom: 1px solid #ddd;
            margin-bottom: 2mm;
            font-size: 9px;
            flex-shrink: 0;
        }

        .header-item {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .h-label {
            font-weight: 700;
            text-transform: uppercase;
            color: #666;
            font-size: 8px;
            letter-spacing: 0.3px;
        }

        .h-value {
            font-weight: 600;
            color: #000;
            font-size: 9px;
        }

        /* PRIORIDADE - Apenas texto colorido */
        .prioridade-tag {
            font-weight: 700;
            text-transform: uppercase;
            font-size: 9px;
        }

        .prioridade-alta-tag {
            color: #d32f2f;
        }

        .prioridade-media-tag {
            color: #f57f17;
        }

        .prioridade-baixa-tag {
            color: #388e3c;
        }

        /* SE√á√ÉO PRINCIPAL - 125mm */
        .main-section {
            display: flex;
            gap: 3mm;
            height: 125mm;
            max-height: 125mm;
            overflow: hidden;
            flex-shrink: 0;
            margin-bottom: 0;
        }

        /* COLUNA ESQUERDA */
        .col-left {
            flex: 0 0 90mm;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* PEDIDO E CLIENTE - 20mm M√ÅXIMO */
        .pedido-box {
            padding-bottom: 2mm;
            margin-bottom: 2mm;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
            height: 20mm;
            max-height: 20mm;
            overflow: hidden;
        }

        .pedido-numero {
            font-size: 24px;
            font-weight: 800;
            line-height: 0.95;
            margin-bottom: 1mm;
            color: #000;
            white-space: nowrap;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .badge-reposicao {
            display: inline-block;
            background: #ff6b35;
            color: #fff;
            padding: 1px 6px;
            font-size: 7px;
            font-weight: 700;
            border-radius: 3px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-left: 4px;
            vertical-align: middle;
        }

        .cliente-info-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 2mm;
        }

        .cliente-details {
            flex: 1;
            min-width: 0;
        }

        .cliente-nome {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 1mm;
            line-height: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #000;
        }

        .cliente-info {
            font-size: 8px;
            color: #666;
            line-height: 1.2;
        }

        .tipo-badge {
            display: inline-block;
            padding: 2px 6px;
            font-weight: 700;
            font-size: 7px;
            text-transform: uppercase;
            border-radius: 3px;
            white-space: nowrap;
            flex-shrink: 0;
            border: 1px solid;
        }

        .tipo-badge.painel {
            color: #1976d2;
            border-color: #1976d2;
        }

        .tipo-badge.lona {
            color: #388e3c;
            border-color: #388e3c;
        }

        .tipo-badge.totem {
            color: #7b1fa2;
            border-color: #7b1fa2;
        }

        .tipo-badge.adesivo {
            color: #f57c00;
            border-color: #f57c00;
        }

        /* CONTE√öDO ESQUERDA */
        .left-content {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .produto-nome {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 2mm;
            line-height: 1.1;
            max-height: 8mm;
            overflow: hidden;
            color: #000;
            border-left: 2px solid #1976d2;
            padding-left: 2mm;
            flex-shrink: 0;
        }

        /* INFO GRID - 12mm */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 3mm;
            margin-bottom: 2mm;
            height: 12mm;
            max-height: 12mm;
            overflow: hidden;
            flex-shrink: 0;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 7px;
            font-weight: 700;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 1mm;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 10px;
            font-weight: 700;
            color: #000;
            line-height: 1.1;
        }

        .qty-box {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            justify-content: center;
        }

        .qty-label {
            font-size: 7px;
            font-weight: 700;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 1mm;
        }

        .qty {
            font-size: 20px;
            font-weight: 900;
            color: #d32f2f;
            line-height: 1;
        }

        /* FICHA T√âCNICA - 9mm */
        .tech-section {
            margin-bottom: 2mm;
            font-size: 8px;
            height: 9mm;
            max-height: 9mm;
            overflow: hidden;
            border-left: 2px solid #e0e0e0;
            padding-left: 2mm;
            flex-shrink: 0;
        }

        .tech-item {
            margin-bottom: 1mm;
            color: #424242;
            line-height: 1.3;
        }

        .tech-label {
            font-weight: 700;
            color: #616161;
        }

        .tech-value {
            color: #212121;
        }

        /* SPECS - 25mm */
        .specs {
            font-size: 8px;
            line-height: 1.4;
            height: 25mm;
            max-height: 25mm;
            overflow: hidden;
            flex-shrink: 0;
        }

        .specs li {
            list-style: none;
            padding-left: 10px;
            position: relative;
            margin-bottom: 1mm;
            color: #333;
        }

        .specs li::before {
            content: "‚ñ™";
            position: absolute;
            left: 0;
            font-weight: 700;
            color: #666;
        }

        .specs b {
            color: #000;
            font-weight: 700;
        }

        /* OBSERVA√á√ïES - 14mm m√°ximo */
        .obs-container {
            height: 14mm;
            max-height: 14mm;
            overflow: hidden;
            margin-top: auto;
            padding-top: 2mm;
            flex-shrink: 0;
        }

        .obs {
            border-left: 3px solid #ff9800;
            padding-left: 2mm;
            font-size: 7px;
            line-height: 1.3;
            height: 100%;
            overflow: hidden;
        }

        .obs.pedido {
            border-left-color: #2196f3;
        }

        .obs-title {
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 1mm;
            color: #666;
            font-size: 7px;
        }

        /* COLUNA DIREITA - IMAGEM */
        .col-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
        }

        .img-title {
            font-size: 7px;
            font-weight: 700;
            text-transform: uppercase;
            color: #999;
            text-align: center;
            margin-bottom: 2mm;
            flex-shrink: 0;
        }

        .img-box {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 3px;
            background: #fafafa;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            max-height: 110mm;
            min-height: 0;
            gap: 2mm;
            padding: 1mm;
        }

        .img-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
            flex-shrink: 1;
            /* Permite diminuir para caber mais de uma */
        }

        .no-img-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            color: #ccc;
        }

        .no-img {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .img-caption {
            font-size: 8px;
            color: #666;
            text-align: center;
            margin-top: 2mm;
            font-style: italic;
            height: 4mm;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        /* FOOTER - 7mm */
        .footer {
            position: absolute;
            bottom: 4mm;
            left: 4mm;
            right: 4mm;
            height: 7mm;
            border-top: 1px solid #ddd;
            padding-top: 1mm;
            display: flex;
            justify-content: space-between;
            font-size: 7px;
            background: #fff;
            overflow: hidden;
        }

        .footer-item {
            flex: 1;
        }

        .footer-label {
            font-size: 7px;
            font-weight: 700;
            text-transform: uppercase;
            color: #999;
        }

        .footer-value {
            font-weight: 600;
            color: #000;
            margin-top: 1mm;
            font-size: 8px;
        }

        .footer-right {
            text-align: right;
            color: #666;
            font-size: 7px;
        }
    </style>
</head>

<body>

    {{#each pages}}
    <div class="page"
        style="width: 210mm; height: 297mm; page-break-after: always; page-break-inside: avoid; overflow: hidden;">
        {{#each items}}
        {{#if descricao}}
        <div class="ficha">
            <!-- HEADER -->
            <div class="header">
                <div class="header-item">
                    <span class="h-label">Data Envio:</span>
                    <span class="h-value">{{data_envio}}</span>
                </div>
                <div class="header-item">
                    <span class="h-label">Prioridade:</span>
                    <span
                        class="prioridade-tag {{#if (eq prioridade 'Alta')}}prioridade-alta-tag{{else}}{{#if (eq prioridade 'M√©dia')}}prioridade-media-tag{{else}}prioridade-baixa-tag{{/if}}{{/if}}">
                        {{prioridade}}
                    </span>
                </div>
                <div class="header-item">
                    <span class="h-label">Transporte:</span>
                    <span class="h-value">{{forma_envio}}</span>
                </div>
            </div>

            <!-- CONTE√öDO PRINCIPAL -->
            <div class="main-section">
                <!-- COLUNA ESQUERDA -->
                <div class="col-left">
                    <!-- PEDIDO E CLIENTE -->
                    <div class="pedido-box">
                        <div class="pedido-numero">
                            #{{numero}}
                            {{#if is_reposicao}}
                            <span class="badge-reposicao">REPOSI√á√ÉO</span>
                            {{/if}}
                        </div>
                        <div class="cliente-info-wrapper">
                            <div class="cliente-details">
                                <div class="cliente-nome">{{cliente}}</div>
                                <div class="cliente-info">
                                    {{telefone_cliente}}{{#if cidade_estado}}<br>{{cidade_estado}}{{/if}}
                                </div>
                            </div>
                            <span class="tipo-badge {{tipo_producao}}">{{tipo_producao}}</span>
                        </div>
                    </div>

                    <div class="left-content">
                        <!-- PRODUTO -->
                        <div class="produto-nome">{{descricao}}</div>

                        <!-- INFO GRID -->
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-label">Dimens√µes</div>
                                <div class="info-value">{{dimensoes}}</div>
                            </div>
                            <div class="qty-box">
                                <div class="qty-label">QTD</div>
                                <div class="qty">{{quantity}}</div>
                            </div>
                        </div>

                        <!-- FICHA T√âCNICA -->
                        <div class="tech-section">
                            <div class="tech-item">
                                <span class="tech-label">Material:</span>
                                <span class="tech-value">{{material}}</span>
                            </div>
                            <div class="tech-item">
                                <span class="tech-label">Emenda:</span>
                                <span class="tech-value">{{emenda_label}}{{#if emenda_qtd}}
                                    ({{emenda_qtd}}){{/if}}</span>
                            </div>
                        </div>

                        <!-- ESPECIFICA√á√ïES -->
                        <ul class="specs">
                            {{#if (eq tipo_producao 'painel')}}
                            <li><b>Acabamento:</b> {{acabamentos_painel}}</li>
                            <li><b>Costura:</b> Overloque ({{overloque}}) / El√°stico ({{elastico}})</li>
                            <li><b>Ilh√≥s:</b> {{ilhos_resumo}} | <b>Corda:</b> {{cordinha_resumo}}</li>
                            {{/if}}

                            {{#if (eq tipo_producao 'totem')}}
                            <li><b>Acabamento:</b> {{acabamento_totem_resumo}}</li>
                            {{#if quantidade_totem}}<li><b>Quantidade:</b> {{quantidade_totem}}</li>{{/if}}
                            {{/if}}

                            {{#if (eq tipo_producao 'lona')}}
                            <li><b>Acabamento:</b> {{acabamento_lona}}</li>
                            <li><b>Ilh√≥s:</b> {{quantidade_ilhos}} ({{espaco_ilhos}})</li>
                            {{/if}}

                            {{#if (eq tipo_producao 'adesivo')}}
                            <li><b>Tipo:</b> {{tipo_adesivo}} | <b>Qtd:</b> {{quantidade_adesivo}}</li>
                            {{/if}}
                        </ul>

                        <!-- OBSERVA√á√ïES -->
                        <div class="obs-container">
                            {{#if observacao_pedido}}
                            <div class="obs pedido">
                                <div class="obs-title">üìã Observa√ß√µes do Pedido</div>
                                <div>{{observacao_pedido}}</div>
                            </div>
                            {{/if}}

                            {{#if observacao_item}}
                            <div class="obs">
                                <div class="obs-title">‚öôÔ∏è Observa√ß√µes de Produ√ß√£o</div>
                                <div>{{observacao_item}}</div>
                            </div>
                            {{/if}}
                        </div>
                    </div>
                </div>

                <!-- COLUNA DIREITA - IMAGEM -->
                <div class="col-right">
                    <div class="img-title">Visualiza√ß√£o da Arte</div>
                    <div class="img-box">
                        {{#if imagens}}
                        {{#each imagens}}
                        <img src="{{this}}" alt="Arte {{@index}}" onerror="this.style.display='none';">
                        {{/each}}
                        {{else}}
                        {{#if imagem}}
                        <img src="{{imagem}}" alt="Arte"
                            onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\'no-img-wrapper\'><span class=\'no-img\'>ERRO NA IMAGEM</span></div>';">
                        {{else}}
                        <div class="no-img-wrapper">
                            <span class="no-img">SEM PR√âVIA</span>
                        </div>
                        {{/if}}
                        {{/if}}
                    </div>
                    {{#if legenda_imagem}}
                    <div class="img-caption">{{legenda_imagem}}</div>
                    {{/if}}
                </div>
            </div>

            <!-- FOOTER -->
            <div class="footer">
                <div class="footer-item">
                    <div class="footer-label">Designer</div>
                    <div class="footer-value">{{designer}}</div>
                </div>
                <div class="footer-item">
                    <div class="footer-label">Vendedor</div>
                    <div class="footer-value">{{vendedor}}</div>
                </div>
                <div class="footer-item footer-right">
                    <div class="footer-label">Controle de Produ√ß√£o</div>
                    <div>RIP: _______ DATA: __/__/__</div>
                </div>
            </div>
        </div>
        {{/if}}
        {{/each}}
    </div>
    {{/each}}

</body>

</html>